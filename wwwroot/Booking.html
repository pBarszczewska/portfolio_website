<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Booking System</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Google Font -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet" />

  <style>
    body {
      font-family: "Poppins", sans-serif;
      display: flex;
      justify-content: center;
      align-items: center;  
      flex-direction: column;
      color: #2e3d3a;
      background-color: #fafafa;
      scroll-behavior: smooth;
    }
    header {
      /* minimal transparent background */
      background-color: rgba(255,255,255,0.8);
      backdrop-filter: blur(10px);
    }

    /* pattern background */
    .pattern-bg {
        background-image: url('https://img.freepik.com/premium-vector/greenery-wedding-invitation-design-with-floral-watercolor_118960-4626.jpg?semt=ais_hybrid&w=740&q=80');
      background-size: cover;
      background-position: center;
    }
    

    /* Container for booking step */
  #booking-step {
    display: none;
    border: 2px solid #ccc;
    border-radius: 12px;
    padding: 16px;
    max-width: 400px;
    background-color: #f9f9f9;
  }

  /* Selected item name bold */
  #selected-item-name {
    font-weight: bold;
  }

  /* Each label/input on its own line */
  #booking-step label {
    display: block;
    margin: 10px 0;
  }

  #booking-step input[type="datetime-local"],
  #booking-step input[type="number"] {
    display: block;
    width: 100%;
    padding: 6px 8px;
    margin-top: 4px;
    border: 1px solid #aaa;
    border-radius: 6px;
    font-size: 1rem;
  }

  /* Buttons container */
  .booking-buttons {
    display: flex;
    justify-content: space-between;
    margin-top: 16px;
    padding: 12px;
    border: 1px solid #ddd;
    border-radius: 10px;
    background-color: #eef2f7;
  }

  /* Style individual buttons */
  .booking-buttons button {
    padding: 8px 16px;
    border-radius: 8px;
    border: none;
    cursor: pointer;
    font-weight: bold;
    transition: background 0.2s;
  }

  .booking-buttons button#book-btn {
    background-color: #4CAF50;
    color: white;
  }

  .booking-buttons button#book-btn:hover {
    background-color: #45a049;
  }

  .booking-buttons button.back-btn {
    background-color: #f44336;
    color: white;
  }

  .booking-buttons button.back-btn:hover {
    background-color: #da190b;
  }
  </style>

</head>

<body class="pattern-bg text-gray-900 min-h-screen flex flex-col items-center justify-center">

      <!-- Navigation -->
  <header class="fixed top-0 left-0 w-full z-50">
    <nav class="max-w-5xl mx-auto flex justify-between items-center py-4 px-6">
      <h1 class="text-xl font-semibold text-gray-800">Paulina Barszczewska</h1>
      <ul class="flex space-x-6 text-gray-600 font-medium">
        <li><a id="homeMenu" href="index.html#home" class="hover:text-gray-800">Home</a></li>
        <li><a id="aboutMenu" href="index.html#about" class="hover:text-gray-800">About</a></li>
        <li><a id="workMenu" href="index.html#work" class="hover:text-gray-800">Work</a></li>
          <li><a id="educationMenu" href="#index.html#education" class="hover:text-gray-800">Education</a></li>
        <li><a id="contactMenu" href="index.html#contact" class="hover:text-gray-800">Contact</a></li>
        <li class="relative">
          <button id="langButton" class="hover:text-gray-800 focus:outline-none">Language â–¼</button>
          <!-- Dropdown -->
          <div id="langDropdown" class="absolute hidden right-0 mt-2 w-32 bg-white/90 backdrop-blur-md rounded-lg shadow-lg text-center">
            <button class="block w-full py-2 hover:bg-gray-700" onclick="setLanguage('en')">ðŸ‡¬ðŸ‡§ English</button>
            <button class="block w-full py-2 hover:bg-gray-700" onclick="setLanguage('es')">ðŸ‡ªðŸ‡¸ EspaÃ±ol</button>
            <button class="block w-full py-2 hover:bg-gray-700" onclick="setLanguage('pl')">ðŸ‡µðŸ‡± Polski</button>
          </div>
        </li>
      </ul>
    </nav>
  </header>


  <!-- Booking section -->
  <div id="app" class="bg-white shadow-lg rounded-2xl p-6 w-full max-w-lg space-y-6">
    <h1 id="loginSectionHeader" class="hidden text-3xl font-bold text-center text-gray-800">Please log in to make a reservation</h1>

    <div id="loginSection" class="space-y-3">
      <h2 class="text-xl font-semibold">Login</h2>
      <input id="loginUsername" class="border border-gray-300 rounded p-2 w-full" placeholder="Username">
      <input id="loginPassword" type="password" class="border border-gray-300 rounded p-2 w-full" placeholder="Password">
      <button onclick="login()" class="bg-gray-500 hover:bg-gray-600 text-white w-full py-2 rounded">Login</button>

      <p id="noAccount" class="text-center text-sm text-gray-500"></p>
    </div>

    <div id="register-section" class="space-y-3 hidden">
      <h2 class="text-xl font-semibold">Register</h2>
      <input id="regUsername" class="border border-gray-300 rounded p-2 w-full" placeholder="Username">
      <input id="regPassword" type="password" class="border border-gray-300 rounded p-2 w-full" placeholder="Password">
      <input id="regEmail" type="email" class="border border-gray-300 rounded p-2 w-full" placeholder="Example@email.com">
      <!--<button onclick="register()" class="bg-green-500 hover:bg-green-600 text-white w-full py-2 rounded">Register</button>-->
      <button id="registerBtn" class="bg-green-500 hover:bg-green-600 text-white w-full py-2 rounded">Register</button>

      <p id="alreadyReg" class="text-center text-sm text-gray-500"></p>
      
      <div id="gdpr" class="text-gray-400 text-sm mt-4"></div>
    </div>

    <div id="booking-section" class="hidden">
      <div id="items-step">
        <h3>Select Item</h3>
        <div id="items-list"></div>
      </div>

      <div id="booking-step">
        <h3>Book <span id="selected-item-name"></span></h3>
        
        <label>
          Start:
          <input type="datetime-local" id="startDate" />
        </label>
        
        <label>
          Duration (hours, optional):
          <input type="number" id="duration" min="1" />
        </label>
        
        <label>
          Whole Day:
          <input type="checkbox" id="wholeDay" />
        </label>
        <div class="booking-buttons">
          <button id="book-btn">Book</button>
          <button class=" back-btn" onclick="showItemsStep()">Back</button>
        </div>
      </div>

      <div id="my-bookings-section" class="mt-6">
        <h3 class="text-lg font-semibold mb-2">My Bookings</h3>
        <div id="my-bookings" class="space-y-2"></div>
      </div>

    </div>

    <div id="admin-section" class="hidden">
      <h2 class="text-2xl font-semibold text-red-600">Admin Panel</h2>
      <div class="space-y-3">
        <button onclick="loadAllBookings()" class="bg-gray-700 text-white px-4 py-2 rounded">View All Bookings</button>
        <button onclick="loadAllItems()" class="bg-gray-700 text-white px-4 py-2 rounded">Manage Items</button>
      </div>
      <div id="admin-content" class="mt-4"></div>
    </div>

    <button id="logout-btn" onclick="logout()" class="bg-gray-300 hover:bg-gray-400 text-gray-800 w-full py-2 rounded hidden">Logout</button>
  </div>
</div>

  <footer id="rights" class="text-center mt-20 mb-10 text-sm text-gray-500">
    Â© <span id="year"></span> Paulina Barszczewska. All rights reserved.
  </footer>



<script>
  const API_BASE = "https://paulinabarszczewska-cyh7cfdbevb4f0eh.westeurope-01.azurewebsites.net/api";
  //left for testing
  //const API_BASE = "http://localhost:5011/api";

  let currentUser = JSON.parse(localStorage.getItem("currentUser"));

  document.addEventListener("DOMContentLoaded", () => {
      if (currentUser) {
          console.log("Logged in as:", currentUser.username);
          showBooking();
      } else {
          console.log("No user found in localStorage.");
          showLogin();
      }
  });

if (currentUser) {
  document.getElementById('logout-btn')?.classList.remove('hidden');
  if (currentUser.isAdmin) {
    document.getElementById('admin-section')?.classList.remove('hidden');
  }
}


function showRegister() 
{
  document.getElementById('loginSection').classList.add('hidden');
  document.getElementById('register-section').classList.remove('hidden');
}

function showLogin() 
{
  document.getElementById('register-section').classList.add('hidden');
  document.getElementById('loginSection').classList.remove('hidden');
}

function showBooking() 
{
  document.getElementById('loginSection').classList.add('hidden');
  document.getElementById('register-section').classList.add('hidden');

  const bookingSection = document.getElementById('booking-section');
  bookingSection.classList.remove('hidden'); // make visible

  loadItems();
  loadBookings();
}

document.addEventListener("DOMContentLoaded", () => {
    const registerBtn = document.getElementById("registerBtn");
    registerBtn.onclick = register;
});

async function register() 
{
  const usernameIn = document.getElementById('regUsername').value.trim();
  const passwordIn = document.getElementById('regPassword').value.trim();
  const emailIn = document.getElementById('regEmail').value.trim();
  if (!usernameIn || !passwordIn || !emailIn) return alert('One or more inputs are missing');

  const body = {
    Email: emailIn,
    Username: usernameIn,
    Password: passwordIn
  };

  const res = await fetch(`${API_BASE}/User/register`, {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({body})
  });
  if (res.ok) {
    alert('Registered! You can now log in.');
    showLogin();
  } else {
    alert('Registration failed.');
  }
}

async function login() 
{
  const username = document.getElementById('loginUsername').value.trim();
  const password = document.getElementById('loginPassword').value.trim();

  const res = await fetch(`${API_BASE}/User/login`, {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ username, password })
  });

  if (res.ok) 
  {
    currentUser = await res.json();
    localStorage.setItem("currentUser", JSON.stringify(currentUser));
    showBooking();
    document.getElementById('logout-btn').classList.remove('hidden'); // show logout
    if (currentUser.isAdmin) 
    {
      document.getElementById('admin-section').classList.remove('hidden');
    }
  } else {
    alert('Login failed.');
  }
}

let selectedItem = null;

async function loadItems() 
{
  const res = await fetch(`${API_BASE}/Item/all`);
  const items = await res.json();
  const container = document.getElementById('items-list');
  container.innerHTML = '';

  if (!items.length) {
    container.innerHTML = '<p class="text-gray-400">No available items.</p>';
    return;
  }

  items.forEach(i => {
    const div = document.createElement('div');
    div.className = 'flex justify-between items-center p-3 border rounded';
    const span = document.createElement('span');
    span.textContent = `${i.name}`;

    const btn = document.createElement('button');
    btn.textContent = 'Select';
    btn.className = 'bg-gray-500 text-white px-3 py-1 rounded hover:bg-gray-600';

    // attach click handler properly
    btn.addEventListener('click', () => selectItem(i.name));

    div.appendChild(span);
    div.appendChild(btn);
    container.appendChild(div);
  });
}

function selectItem(itemname) 
{
  console.log('Selected item:', itemname);
  selectedItem = itemname;
  document.getElementById('selected-item-name').textContent = itemname;

  // Show booking step
  document.getElementById('items-step').style.display = 'none';
  document.getElementById('booking-step').style.display = 'block';
}
window.selectItem = selectItem; 

function showItemsStep() 
{
  document.getElementById('items-step').style.display = 'block';
  document.getElementById('booking-step').style.display = 'none';
}

document.getElementById('book-btn').addEventListener('click', async () => {
  if (!currentUser) return alert('Please log in.');
  if (!selectedItem) return alert('No item selected.');

  const startDate = document.getElementById('startDate').value;
  const duration = document.getElementById('duration').value;
  const wholeDay = document.getElementById('wholeDay').checked;

  if (!startDate) return alert('Please select a start time.');

  const url = new URL(`${API_BASE}/Booking`);
  url.searchParams.append('username', currentUser.username);
  url.searchParams.append('email', currentUser.email);
  url.searchParams.append('itemname', selectedItem);
  url.searchParams.append('startDate', startDate);
  if (duration) url.searchParams.append('durationHours', duration);
  if (wholeDay) url.searchParams.append('wholeDay', wholeDay);

  const res = await fetch(url, { method: 'POST' });

  if (res.ok) {
    alert('Booking successful!');
    loadItems();
    loadBookings();
    showItemsStep(); // go back to items list
  } else {
    const error = await res.text();
    alert(`Booking failed: ${error}`);
  }
});

loadItems();


async function loadBookings() 
{
  if (!currentUser) return;

  const res = await fetch(`${API_BASE}/Booking/user/${currentUser.username}`);
  if (!res.ok) {
    document.getElementById('my-bookings').innerHTML = '<p class="text-gray-400">No bookings found.</p>';
    return;
  }

  const bookings = await res.json();
  const container = document.getElementById('my-bookings');
  container.innerHTML = '';

  if (!bookings.length) {
    container.innerHTML = '<p class="text-gray-400">No active bookings.</p>';
    return;
  }

  bookings.forEach(b => {
    const div = document.createElement('div');
    div.id = `booking-${b.id}`;
    div.className = 'flex justify-between items-center p-3 border rounded';
    div.innerHTML = `
      <span><strong>${b.itemName}</strong> â€” ${new Date(b.startDate).toLocaleString()}</span>
      <button onclick="cancelBooking(${b.id})" class="bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600">Cancel</button>
    `;
    container.appendChild(div);
  });
}


async function book(itemname) 
{
  if (!currentUser) {
    alert('Please log in first.');
    return;
  }

  if (!currentUser.email) {
    alert('Please ensure your email is saved in your account.');
    return;
  }

  const startInput = document.getElementById(`startDate-${itemname}`) || document.getElementById('startDate');
  const endInput = document.getElementById(`endDate-${itemname}`) || document.getElementById('endDate');

  const startLocal = startInput?.value;
  const endLocal   = endInput?.value;

  if (!startLocal) {
  alert('Please select a start date.');
  return;
  }

  // Helper: convert YYYY-MM-DD â†’ local datetime string (no timezone)
  function toLocalDateISOString(localDate) {
    const [year, month, day] = localDate.split('-');
    return `${year}-${month}-${day}T00:00:00`; // Keep local time, no UTC shift
  }

  const startDate = toLocalDateISOString(startLocal);
  const endDate = toLocalDateISOString(endLocal);

  const params = new URLSearchParams()
  params.append('email', currentUser.email);
  params.append('itemname', itemname);
  params.append('startDate', startDate);
  params.append('durationHours', duration);
  params.append('wholeDay', wholeDay);

  const res = await fetch(`${API_BASE}/Booking?${params}`, {
    method: 'POST'
  });

  if (res.ok) {
    alert('Booking successful!');
    loadItems();
    loadBookings();
  } else {
    const msg = await res.text();
    alert(`Booking failed: ${msg}`);
  }
}


async function cancelBooking(id) 
{
  if (!confirm('Are you sure you want to cancel this booking?')) return;

  const res = await fetch(`${API_BASE}/Booking/cancel?id=${id}`, { method: 'DELETE' });
  if (res.ok) {
    alert('Booking cancelled.');
    // remove the booking element instantly
    document.querySelector(`#booking-${id}`)?.remove();
    //reload availability after dely
    setTimeout(() => loadItems(), 300);
    loadBookings();
  } else {
    const msg = await res.text();
    alert('Failed to cancel booking.');
  }
}

// admin functions
async function loadAllBookings() 
{
  console.log("Admin clicked: Manage Bookings");
  const res = await fetch(`${API_BASE}/Booking`);
  if (!res.ok) return alert('Failed to load bookings');
  const bookings = await res.json();
  const container = document.getElementById('admin-content');
  container.innerHTML = '<h3 class="text-lg font-semibold">All Bookings</h3>';
    bookings.forEach(b => {
    const div = document.createElement('div');
    div.className = 'flex justify-between items-center p-3 border rounded mb-2';
    div.innerHTML = `
      <span>${b.userName} booked ${b.itemName} (${b.startDate} â†’ ${b.endDate})/span>
      <button class="bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600 admin-btn" onclick="adminCancelBooking(${b.id})">Cancel</button>
      <button class="bg-yellow-500 text-white px-3 py-1 rounded hover:bg-yellow-600 admin-btn" onclick="adminChangeBooking(${b.id})">Change</button>`;
          container.appendChild(div);
  });
}

async function adminCancelBooking(id) {
  if (!confirm('Are you sure you want to cancel this booking?')) return;

  const res = await fetch(`${API_BASE}/Booking/cancel?id=${id}`, { method: 'DELETE' });
  if (res.ok) {
    alert('Booking cancelled.');
    document.getElementById('view-all-bookings-btn').click(); // reload all bookings
    loadItems(); // refresh item availability
  } else {
    alert('Failed to cancel booking.');
  }
}

let bookingToChange = null; // global variable to track the booking being changed

async function adminChangeBooking(id) 
{
  if (!currentUser || !currentUser.isAdmin) return alert('Admin only.');

  // Fetch the booking details
  const res = await fetch(`${API_BASE}/Booking`);
  if (!res.ok) return alert('Failed to load bookings.');

  const bookings = await res.json();

  const booking = bookings.find(b => b.id === id);
  if (!booking) return alert('Booking not found.');

  bookingToChange = booking.id;       // mark this booking for editing
  selectedItem = booking.itemName;    // pre-select the item

  // Pre-fill the booking form
  document.getElementById('selected-item-name').textContent = booking.itemName;
  document.getElementById('startDate').value = new Date(booking.startDate).toISOString().slice(0, 16);

  const durationHours = (new Date(booking.endDate) - new Date(booking.startDate)) / (1000 * 60 * 60);
  document.getElementById('duration').value = durationHours >= 24 ? '' : durationHours;
  document.getElementById('wholeDay').checked = durationHours >= 24;

  // Show booking step and hide items list
  document.getElementById('items-step').style.display = 'none';
  document.getElementById('booking-step').style.display = 'block';

  // Update the "Book" button to handle editing
  const bookBtn = document.getElementById('book-btn');
  bookBtn.textContent = 'Update Booking';
  bookBtn.onclick = async () => 
  {
    if (!currentUser) return alert('Please log in.');
    if (!selectedItem) return alert('No item selected.');

    const startDate = document.getElementById('startDate').value;
    const duration = document.getElementById('duration').value;
    const wholeDay = document.getElementById('wholeDay').checked;

    if (!startDate) return alert('Please select a start time.');

    const url = new URL(
        bookingToChange 
          ? `${API_BASE}/Booking/change`  // if editing
          : `${API_BASE}/Booking/book`    // if new booking
      );

    // common parameters 
    url.searchParams.append('username', currentUser.username);
    url.searchParams.append('email', currentUser.email);
    url.searchParams.append('itemname', selectedItem);
    url.searchParams.append('startDate', startDate);
    if (duration) url.searchParams.append('durationHours', duration);
    if (wholeDay) url.searchParams.append('wholeDay', wholeDay);
    // Only include bookingId if itâ€™s really a change
    if (bookingToChange) {
      url.searchParams.append('bookingId', bookingToChange);
    }

    const method = bookingToChange ? 'PUT' : 'POST';
    const res = await fetch(url, { method });

    if (res.ok) {
      alert(bookingToChange ? 'Booking updated!' : 'Booking successful!');
      bookingToChange = null;
      bookBtn.textContent = 'Book';
      loadItems();
      loadBookings();
      showItemsStep();
    } else {
      const msg = await res.text();
      alert(`Failed to update booking: ${msg}`);

      loadAllBookings();
    };
  }
}

async function loadAllItems() {
  if (!currentUser || !currentUser.isAdmin) {
    alert('Admins only.');
    return;
  }

  console.log("Admin clicked: Manage Items");

  const container = document.getElementById('admin-content');
  if (!container) {
    console.error("No element with id='admin-content' found.");
    return;
  }

  container.innerHTML = '<h3 class="text-lg font-semibold mb-2">Manage Items</h3>';

  try {
    const res = await fetch(`${API_BASE}/Item/all`);
    if (!res.ok) {
      throw new Error(`Failed to load items: ${res.status}`);
    }

    const items = await res.json();
    console.log("Loaded items:", items);

    if (!items.length) {
      container.innerHTML += '<p>No items found.</p>';
    }

    // Dropdown
    const select = document.createElement('select');
    select.id = 'item-select';
    select.className = 'border p-2 rounded w-full mb-2';
    select.innerHTML = '<option value="">-- Select an item --</option>';
    items.forEach(i => {
      const opt = document.createElement('option');
      opt.value = i.id;
      opt.textContent = i.name;
      select.appendChild(opt);
    });
    container.appendChild(select);

    // Input for renaming
    const input = document.createElement('input');
    input.id = 'new-item-name';
    input.type = 'text';
    input.placeholder = 'Enter new name';
    input.className = 'border p-2 rounded w-full mb-2';
    container.appendChild(input);

    // Buttons
    const btnDiv = document.createElement('div');
    btnDiv.className = 'flex gap-2';

    // Rename button
    const renameBtn = document.createElement('button');
    renameBtn.textContent = 'Rename';
    renameBtn.className = 'bg-yellow-500 text-white px-3 py-1 rounded hover:bg-yellow-600';
    renameBtn.onclick = async () => {
      const id = select.value;
      const newName = input.value.trim();
      if (!id) return alert('Select an item first.');
      if (!newName) return alert('Enter a new name.');

      const params = new URLSearchParams({ id, name: newName });
      const res = await fetch(`${API_BASE}/Item/update?${params}`, { method: 'PUT' });

      if (res.ok) {
        alert('Item renamed successfully.');
        loadAllItems();
        loadItems();
      } else {
        const msg = await res.text();
        alert(`Failed to rename: ${msg}`);
      }
    };

    // Delete button
    const deleteBtn = document.createElement('button');
    deleteBtn.textContent = 'Delete';
    deleteBtn.className = 'bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600';
    deleteBtn.onclick = async () => {
      const id = select.value;
      if (!id) return alert('Select an item first.');
      if (!confirm('Are you sure you want to delete this item?')) return;

      const res = await fetch(`${API_BASE}/Item/delete?id=${id}`, { method: 'DELETE' });
      if (res.ok) {
        alert('Item deleted successfully.');
        loadAllItems();
        loadItems();
      } else {
        const msg = await res.text();
        alert(`Failed to delete: ${msg}`);
      }
    };

     // Add Item
    const addBtn = document.createElement('button');
    addBtn.textContent = 'Add';
    addBtn.className = 'bg-green-500 text-white px-3 py-1 rounded hover:bg-green-600';
    addBtn.onclick = async () => {
      const id = select.value;
      const newName = input.value.trim();

      // Only allow add if no item is selected and a name is provided
      if (id) return alert('Deselect an item to add a new one.');

      const res = await fetch(`${API_BASE}/Item/add`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ name: newName })
      });

      if (res.ok) {
        alert('Item added successfully.');
        loadAllItems();
        loadItems();
      } else {
        const msg = await res.text();
        alert(`Failed to add item: ${msg}`);
      }
  };

    btnDiv.appendChild(renameBtn);
    btnDiv.appendChild(deleteBtn);
    btnDiv.appendChild(addBtn);
    container.appendChild(btnDiv);

  } catch (err) {
    console.error("Error in loadAllItems():", err);
    alert('Error loading items. Check console for details.');
  }
}


function logout() 
{
  localStorage.removeItem("currentUser");
  currentUser = null;
  showLogin();
  document.getElementById('logout-btn').classList.add('hidden'); // hide logout
  document.getElementById('admin-section').classList.add('hidden');
  document.getElementById('booking-section').classList.add('hidden');

}
</script>

  <script>
    const translations = {
      en: {
        gdpr: ` 
        <p>By registering, you agree to our Privacy Policy.</p>
        <ul>
          <li>We collect your email and login credentials to create and manage your account.</li>
          <li>Passwords are securely hashed and never stored in plain text. </li>
          <li>Your data is not shared with third parties. </li>
          <li>You may request deletion of your account at any time.</li>
        </ul>`,
        aboutMenu: "About Me",
        contactMenu: "Contact",
        langButton:"Language",
        workMenu:"My work",
        homeMenu:"Home",
        loginSectionHeader:"Please log in to make a reservation",    
        noAccount:`No account? 
        <a href="#" onclick="showRegister()" class="text-gray-700 hover:underline">Register</a>`,
        alreadyReg:`Already registered? 
        <a href="#" onclick="showLogin()" class="text-gray-700 hover:underline">Login</a>`,
        loginUsernamePlaceholder:"Username",
        loginPasswordPlaceholder:"Password",
        regUsernamePlaceholder:"Username",
        regPasswordPlaceholder:"Password",
        rights:"Paulina Barszczewska. All rights reserved.",
      },
      es: {
        gdpr: ` 
        <p>Al registrarse, usted acepta nuestra PolÃ­tica de privacidad.</p>
        <ul>
          <li>Recopilamos su correo electrÃ³nico y sus credenciales de inicio de sesiÃ³n para crear y gestionar su cuenta.</li>
          <li>Las contraseÃ±as se cifran de forma segura y nunca se almacenan en texto plano. </li>
          <li>Sus datos no se comparten con terceros. </li>
          <li>Puede solicitar la eliminaciÃ³n de su cuenta en cualquier momento.</li>
        </ul>`,
        aboutMenu: "Sobre mi",
        contactMenu: "Contacto",
        langButton:"Idioma",
        workMenu:"Mi trabajo",
        homeMenu:"Inicio",
        loginSectionHeader:"Inicie sesiÃ³n para realizar una reserva",  
        noAccount:`No tienes una cuenta?
        <a href="#" onclick="showRegister()" class="text-gray-700 hover:underline">RegÃ­strase</a>`,
        alreadyReg:`Ya registrado?
        <a href="#" onclick="showLogin()" class="text-gray-700 hover:underline">Iniciar sesiÃ³n</a>`, 
        loginUsernamePlaceholder:"Nombre de usario",
        loginPasswordPlaceholder:"ContraseÃ±a",
        regUsernamePlaceholder:"Nombre de usario",
        regPasswordPlaceholder:"ContraseÃ±a",
        rights:"Paulina Barszczewska. Todos los derechos reservados.",
      },
      pl: {
        gdpr: ` 
        <p>RejestrujÄ…c siÄ™, wyraÅ¼asz zgodÄ™ na naszÄ… PolitykÄ™ prywatnoÅ›ci.</p>
        <ul>
          <li>Gromadzimy TwÃ³j adres e-mail i dane logowania w celu utworzenia konta i zarzÄ…dzania nim. </li>
          <li>HasÅ‚a sÄ… bezpiecznie szyfrowane i nigdy nie sÄ… przechowywane w postaci zwykÅ‚ego tekstu. </li>
          <li>Twoje dane nie sÄ… udostÄ™pniane osobom trzecim. </li>
          <li>W kaÅ¼dej chwili moÅ¼esz poprosiÄ‡ o usuniÄ™cie swojego konta. </li>
        </ul>`,
        aboutMenu: "O mnie",
        contactMenu: "Kontakt",
        langButton:"Jezyk",
        workMenu:"O pracy",
        homeMenu:"Start",
        loginSectionHeader:"Zaloguj siÄ™, aby dokonaÄ‡ rezerwacji",   
        noAccount:`Nie masz konta?
        <a href="#" onclick="showRegister()" class="text-gray-700 hover:underline">Zarejestruj siÄ™</a>`,
        alreadyReg:`Jestes juÅ¼ zarejestrowany?
        <a href="#" onclick="showLogin()" class="text-gray-700 hover:underline">Zaloguj siÄ™</a>`, 
        loginUsernamePlaceholder:"Nazwa uÅ¼ytkownika",
        loginPasswordPlaceholder:"HasÅ‚o",
        regUsernamePlaceholder:"Nazwa uÅ¼ytkownika",
        regPasswordPlaceholder:"HasÅ‚o",
        rights:"Paulina Barszczewska. Wszelkie prawa zastrzeÅ¼one.",
      }
    };

 function setLanguage(lang) {
      for (const id in translations[lang]) {
        const el = document.getElementById(id);
        if (!el) continue;
        const value = translations[lang][id];

      const placeholderMap = {
        regUsername: "regUsernamePlaceholder",
        regPassword: "regPasswordPlaceholder",
        loginUsername: "loginUsernamePlaceholder",
        loginPassword: "loginPasswordPlaceholder"

      };

      for (const id in placeholderMap) {
        document.getElementById(id).placeholder =
          translations[lang][placeholderMap[id]];
      }
      
      // IDs that should accept HTML (lists, formatted text, etc.)
      const htmlFields = ["gdpr", "noAccount", "alreadyReg"];

      if (htmlFields.includes(id)) {
        el.innerHTML = value;    // allow HTML
      } else {
        el.textContent = value;  // plain text only
      }
    }

      localStorage.setItem('language', lang);
      document.getElementById('langDropdown').classList.add('hidden');
   }

    // Load saved language
    window.onload = () => {
      const lang = localStorage.getItem('language') || 'en';
      setLanguage(lang);
    };

    // Handle dropdown toggle and double-click navigation
    const langButton = document.getElementById('langButton');
    const langDropdown = document.getElementById('langDropdown');
    let clickTimer;

    langButton.addEventListener('click', () => {
      clearTimeout(clickTimer);
      clickTimer = setTimeout(() => {
        langDropdown.classList.toggle('hidden');
      }, 250);
    });

    langButton.addEventListener('dblclick', () => {
      clearTimeout(clickTimer);
      langDropdown.classList.add('hidden');
      document.getElementById('language').scrollIntoView({ behavior: 'smooth' });
    });

  </script>

</body>
</html>
